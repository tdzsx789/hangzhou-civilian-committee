import React, { useState, useEffect, useMemo } from 'react';
import './App.css';
import Home from './pages/Home';
import Detail1 from './pages/Detail1';
import Detail1Second from './pages/Detail1_2';
import Detail2 from './pages/Detail2';
import Detail2Second from './pages/Detail2_2';
// 导入所有图片
import 渔民村文化长廊旧貌 from './assets/images/渔民村文化长廊旧貌.png';
import 渔民村文化长廊新颜 from './assets/images/渔民村文化长廊新颜.png';
import 爱民社区整体面貌 from './assets/images/爱民社区整体面貌.png';
import 爱民社区医保服务站 from './assets/images/爱民社区医保服务站.png';
import 军门社区外景 from './assets/images/军门社区外景.png';
import 军门社区居民恳谈日 from './assets/images/军门社区居民恳谈日.png';
import 西安市雁塔区电子城街道二〇五所社区卫生服务站 from './assets/images/西安市雁塔区电子城街道二〇五所社区卫生服务站.png';
import 社区办公楼新旧对比 from './assets/images/社区办公楼新旧对比.png';
import 社区整体面貌照 from './assets/images/社区整体面貌照.png';
import 开展丰富多彩的文体活动 from './assets/images/开展丰富多彩的文体活动.png';
import 福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比 from './assets/images/福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比.png';
import 福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比2 from './assets/images/福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比2.png';
import 辽宁省沈阳市和平区南湖街道多福社区 from './assets/images/辽宁省沈阳市和平区南湖街道多福社区.png';

// 创建图片名称到图片的映射
const imageMap = {
  '渔民村文化长廊旧貌': 渔民村文化长廊旧貌,
  '渔民村文化长廊新颜': 渔民村文化长廊新颜,
  '爱民社区整体面貌': 爱民社区整体面貌,
  '爱民社区医保服务站': 爱民社区医保服务站,
  '军门社区外景': 军门社区外景,
  '军门社区居民恳谈日': 军门社区居民恳谈日,
  '西安市雁塔区电子城街道二〇五所社区卫生服务站': 西安市雁塔区电子城街道二〇五所社区卫生服务站,
  '社区办公楼新旧对比': 社区办公楼新旧对比,
  '社区整体面貌照': 社区整体面貌照,
  '开展丰富多彩的文体活动': 开展丰富多彩的文体活动,
  '福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比': 福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比,
  '福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比2': 福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比2,
  '辽宁省沈阳市和平区南湖街道多福社区': 辽宁省沈阳市和平区南湖街道多福社区,
};

const list = [
  {
    name: '广东省深圳市罗湖区南湖街道渔邨社区\n2012年12月8日',
    address: '广东省深圳市罗湖区南湖街道渔邨社区',
    text: `2012年12月8日，习近平总书记考察深圳渔邨社区，称赞其"历史性跨越"，勉励居民"用勤劳双手创造更幸福生活"。社区总面积0.51平方公里，管理人口1.1万余人，党委下辖14个党支部、218名党员。十余年来，社区牢记嘱托实现跨越式发展：建成350米文化长廊和278平方米村史馆，累计接待参观4.2万人次；集体经济年收入从900万元增至1348万元，户均资产达6200万元；打造全市首个多功能党群服务中心，实现431项政务"一站通办"。
在基层治理方面，社区创新构建"三级架构"组织体系，形成"居民点单、部门统筹"服务模式，船步街旧改创下99.7%签约率的"渔邨速度"。通过"五家+"工作法、9支志愿队伍等机制动员居民参与治理，党群服务中心周人流量从360人次跃升至5000人次。推进"多网合一"改革，将15个网格整合为4个综合网格，开展2000余人次的便民服务。针对港籍居民占30%的特点，设立港人服务中心，组建深圳首支港人志愿服务队，业委会港籍成员占比达80%。
社区先后获"全国示范性老年友好型社区"等国家级荣誉6项，接待各地调研1574批次，其"政府+公益+商业"党群服务模式、"深港协同"治理经验被《中国组织人事报》等媒体专题报道，成为超大城市基层治理的示范样板。`,
    images: [
      {
        url: '',
        name: '渔民村文化长廊旧貌'
      },
      {
        url: '',
        name: '渔民村文化长廊新颜'
      }
    ]
  },
  {
    name: '辽宁省沈阳市和平区南湖街道多福社区\n2013年8月',
    address: '辽宁省沈阳市和平区南湖街道多福社区',
    text: `沈阳市和平区南湖街道深入践行习近平总书记“与邻为善、以邻为伴”的重要指示。2013年8月，习近平总书记在沈阳市沈河区多福社区考察时强调“社区建设光靠钱不行，要与邻为善、以邻为伴”；2023年9月，总书记回信勉励多福社区居民“继续行善举、做善邻，携手打造更加幸福美好家园”。南湖街道牢记嘱托，立足辖区7.18平方公里、10.2万常住人口的实际，面对人口密集、治理复杂的挑战，坚持党建引领，探索基层治理现代化新路径。
街道构建“街道党工委—社区党委—网格党支部—楼院党小组—党员中心户”五级组织体系，设立120个网格党支部，推动党的组织全覆盖。深化“大工委”“大党委”机制，整合17家街道级、142家社区级共建单位资源，成立全市首个楼宇综合党委，凝聚多元共治合力。组织1247名党员干部开展“敲门行动”，发动101支志愿服务队常态化服务群众，7个无物业小区实现党支部领导下的居民自治。
聚焦民生需求，推进“舒心就业、幸福教育、健康医疗、品质养老”四进社区。搭建就业平台，开展技能培训，帮助579人实现就业；开设“四点半课堂”和老年大学，年授课3400余课时；组建21支家庭医生团队，建立“健康小屋”和智慧急救系统，6年挽救189人生命；打造社区养老服务中心，设立惠民食堂，日均服务3000余名老人。
创新建立“三零”工作室，整合公安、司法、应急等专业力量下沉社区，实现“零事故、零案件、零纠纷”源头治理，年均化解矛盾500余件，成功率超99.5%。通过锻造专业化队伍、建强党群服务阵地、建设智慧治理平台“三向发力”，推动治理资源下沉，实现“人房关联、以房管人”，全面提升基层治理精细化、智能化水平，切实增强居民获得感、幸福感、安全感。`,
    images: [
      {
        url: 辽宁省沈阳市和平区南湖街道多福社区,
        name: `2025年1月23日，沈阳市沈河区滨河街道多福社区的年味渐浓，大家欢聚一堂、共庆新春，编织出一幅幅生动、温暖的“多福迎春图”`
      },
    ]
  },
  {
    name: '内蒙古自治区锡林浩特市楚古兰街道爱民社区\n2014年1月27日',
    address: '内蒙古自治区锡林浩特市楚古兰街道爱民社区',
    text: `2014年1月27日，习近平总书记来到楚古兰街道爱民社区视察指导，他表示，社区党组织和党员干部要千方百计使群众生活更方便一些，使群众表达诉求渠道更畅通一些，把党和政府的温暖送到千家万户。他的殷殷嘱托，对推进城市基层治理体系和治理能力现代化确立了更高标准，对加强和改进城市基层党建工作赋予了新的内涵和使命，也为街道、社区做好各项工作指明了方向，提供了根本遵循。
爱民社区位于锡林浩特市楚古兰街道，成立于2002年，辖区面积0.77平方公里，服务居民2828户、6041人。2014年1月27日，习近平总书记亲临社区视察，强调"社区虽小，却连着千家万户"，叮嘱要"把人民放在心中最高位置"。社区党委下设3个党支部，党员119名，建成2000平方米党群服务中心，内设便民服务大厅、民惠超市等多个功能室。
社区牢记总书记嘱托，创新打造"红色网格"治理体系，划分12个网格并建立党支部，形成"党委-党支部-党小组-党员"组织架构。推行"'五心'工作法"，近两年解决群众需求260多个，满意率达100%。建立9支"暖心服务小分队"，2024年开展"敲门服务"18次，为民办实事200余件。创新实施互嵌式社区治理模式，处理各类纠纷365件，实现"小纠纷不出社区"。
在民生服务方面，社区民惠超市商品种类增至3000种，2023年惠民金额达7.4万元；卫生服务站工作人员从2人增至5人，居民健康档案覆盖率达95%；引进"三宽苑"家庭教育中心，提供心理咨询服务。通过20多项便民举措，切实将总书记的嘱托转化为服务群众的实际行动，先后荣获多项荣誉称号，成为边疆民族地区社区治理的典范。`,
    images: [
      {
        url: '',
        name: '爱民社区整体面貌'
      },
      {
        url: '',
        name: '爱民社区医保服务站'
      }
    ]
  },
  {
    name: '北京市东城区交道口街道福祥社区\n2014年2月25日',
    address: '北京市东城区交道口街道福祥社区',
    text: `2014年2月25日，习近平总书记走进北京交道口街道福祥社区雨儿胡同看望居民时说：“社区管理涉及方方面面，都要照顾到。你们最辛苦，请给社区全体工作人员问好。
交道口街道福祥社区位于东城区交道口街道西南部，辖区面积0.17平方公里，因旧时福祥寺得名。由福祥、雨儿等9条胡同和地安门东大街组成，以老旧平房院落为主，有平房院落193个，楼房小区2个，常住居民1659户、4038人。居委会成立于1957年，社区党委成立于2002年，办公面积600平米，地上两层、地下一层。现有社区工作人员14人，其中党委4人，居委会5人，服务站5人，下设4个网格党支部，党员248名。社区文化底蕴深厚，处在北京市25片历史文化保护区范围内，国家级文保单位2处，市、区级文保单位9处。
福祥社区作为东城区首批七家基层“党建示范点”、“市级优秀社区书记工作室”，以党建引领社区治理为重要抓手，借助平台优势，致力于打造好品牌宣传阵地。在治理实践中提炼出“五新+五心”理念，以不忘“初心”、党群“连心”、胡同“静心”、服务“暖心”、活动“舒心”的“五心”品牌为根基，凝聚智慧，“五新+”通过构建“新理念”、探索基层社会治理新路径；搭设“新平台”、推动形成多元参与的基层治理模式；实现“新联动”、汇聚各方合力打造有文化、有乡愁、有记忆的美好家园；采取“新方法”、以居民议事协商助推基层社区治理；活用“新技术”、科技赋能“智能社区”实现服务群众“零距离”。“五新+五心”的党建品牌，构建起党群同心、细致高效的城市基层社会治理新格局。
近年，福祥社区先后获得北京市思想政治工作优秀单位、首都文明单位、首都最美志愿服务社区、首都最佳志愿服务组织、首都文明街巷、北京市东城区政务服务社区示范站点、东城区五星级基层党组织等荣誉称号。`,
    images: [
      {
        url: 福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比,
        name: '福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比'
      },
      {
        url: 福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比2,
        name: '福祥社区推进南锣鼓巷四条胡同修缮整治新旧对比'
      }
    ]
  },
  {
    name: '福建省福州市鼓楼区东街街道军门社区\n2014年11月',
    address: '福建省福州市鼓楼区东街街道军门社区',
    text: `鼓楼区东街街道军门社区是习近平总书记三次调研的社区（1991年初，第一次调研军门居委会，指出“居委会的办公条件很简陋，今后福州市要通过拆迁改变居委会的办公场所条件”；嘱咐“今后居委会要成立党支部”。1995年4月，第二次调研时当场提笔写下“昔日纸禙军门前，今日文明一枝花”。2014年11月，第三次调研时作出“三个如何”重要指示，指出“社区虽小，但连着千家万户，做好社区工作十分重要。社区的党组织和党员干部天天同居民群众打交道，要多想想如何让群众生活和办事更方便一些，如何让群众表达诉求的渠道更畅通一些，如何让群众感觉更平安、更幸福一些。”）社区组建于1952年，地处福州市中心繁华地段东街口，辖区面积约0.18平方公里，现有楼院68座，常住居民约3380户，人口1.2万余人。社区党委现有15个党支部，328名党员，17名社区工作者。社区认真贯彻落实习近平总书记“三个如何”重要指示精神，巩固深化被民政部作为“一号方案”并在全国推广的军门社区“13335”工作法，坚持深化党建引领，健全共建共治共享机制，率先建成社区“两中心两厅一平台”，并在全省首推无假日社区等机制，让群众生活和办事更方便。`,
    images: [
      {
        url: '',
        name: '军门社区外景'
      },
      {
        url: '',
        name: '军门社区居民恳谈日'
      }
    ]
  },
  {
    name: '陕西省西安市雁塔区电子城街道二〇五所社区\n2015年2月15日',
    address: '陕西省西安市雁塔区电子城街道二〇五所社区',
    text: `二〇五所社区位于西安市雁塔区电子城街道，是中国兵器工业第205研究所建设的单位型社区，现有居民1800多户、3700余人。2015年2月15日，习近平总书记亲临社区视察时强调"社区工作是一门学问"，为社区发展指明方向。十年来，社区牢记嘱托，建成1026平方米党群服务中心，创新打造"五级组织链条"治理体系，通过"红石榴驿站"、"凉亭议事会"等平台解决民生问题千余件，获"全国民主法治示范社区"等30余项荣誉。
社区创新实施"百千万"服务机制："百事帮"邻里互助队解决居民日常困难；"千户访"活动收集并解决操场改造等民生诉求；"万家和"平台营造和谐社区氛围。针对"一老一小"需求，建成嵌入式服务中心，开设寒假托管班等特色服务。2017年建成的社区卫生服务站与多家三甲医院建立医联体，中医文化街区成为特色品牌。社区还打造了西安市首个家风家训馆、非遗工作室等文化阵地，84岁剪纸艺人马月娥等民间艺术家在此传承技艺。
通过党建引领、服务创新和文化培育，社区老年人口占比36%的居民获得感持续提升。2023年成为中国延安干部学院社会实践教学点，其"党建+治理+服务"模式成为城市社区建设的典范，生动践行了习近平总书记"让千家万户感受到党和政府温暖"的殷切嘱托。`,
    images: [
      {
        url: '',
        name: '西安市雁塔区电子城街道二〇五所社区卫生服务站'
      }
    ]
  },
  {
    name: '江西省南昌市东湖区彭家桥街道光明社区\n2016年2月3日',
    address: '江西省南昌市东湖区彭家桥街道光明社区',
    text: `2016年2月3日，在东湖区彭家桥街道光明社区，习近平视察社区宣传栏和社区服务站办事大厅，了解社区党建工作、便民服务、创建和谐等情况。他指出培育社会主义核心价值观是一件大事，全社会都要努力抓，社区要利用自己的平台和优势做好。
光明社区位于南昌市东湖区彭家桥街道，成立于2007年7月，辖区面积12.5万平方米，服务居民1677户、4191人，其中60岁以上老年人1078人。社区党委下设7个实体党支部和10支"趣缘型"党支部，党员276名。近年来，社区深入贯彻落实习近平总书记重要指示精神，创新打造"党建+服务"模式，先后荣获"全国先进基层党组织"等100余项市级以上荣誉称号。
社区以"老有所养、老有所乐"为目标，全面推进适老化改造：一是构建"15分钟生活圈"，配备医疗机构、超市、学校等便民设施；二是建成功能完善的居家养老服务中心，设立老年食堂、健康小屋等场所；三是实施"一户一策"适老化改造，已完成4户家庭改造。同时，社区创新志愿服务模式，开展"1+X搭把手"志愿活动，为老年人提供生活照料、健康管理等服务。
在智慧社区建设方面，社区定期开展"智慧助老"培训活动，帮助老年人跨越数字鸿沟；建立各类微信群，实现"线上点单、志愿者接单"服务模式。文化生活方面，社区打造了"红歌嘹亮"合唱团等19个特色品牌项目，建成孝老文化长廊，丰富居民精神生活。通过党建引领、服务创新，光明社区切实提升了老年人的获得感、幸福感和安全感，成为新时代社区治理的典范。`,
    images: [
      {
        url: '',
        name: '社区办公楼新旧对比'
      }
    ]
  },
  {
    name: '河北省唐山市路北区机场路街道祥富里社区\n2016年7月28日',
    address: '河北省唐山市路北区机场路街道祥富里社区',
    text: `2016 年 7 月 28 日，习近平总书记在纪念唐山抗震 40 周年之际专程来此考察。习近平看到社区工作细致高效，大家精神饱满，肯定了书香社区的建设，称赞大家“腹有诗书气自华”。习近平视察时嘱咐社区党总支书记陈林静，社区是党和政府联系、服务居民群众的“最后一公里”，要健全社区管理和服务体制，整合各种资源，增强社区公共服务能力。陈林静说：“总书记的到来让我们更有信心，更有决心，为居民服务好，让我们的居民更加幸福。”
祥富里社区是唐山市震后第一批安居工程，始建于 1996 年，总面积约 0.5 平方公里，有住宅楼 89 栋、4557 户，人口 1.4 万余，党总支下设 9 个楼栋党支部，党员 646 名。
社区牢记嘱托，强化党组织引领，畅通服务群众 “最后一公里”。围绕 “幸福家园党旗红” 党建品牌，打造了 “陈林静党代表工作室”“365 党员工作室” 等多个平台，创新 “356” 党性教育工作法，开展 “同心圆志愿服务队” 等活动，形成社区党建区域化新格局。
在社区治理方面，祥富里构建起 “六位一体” 治理体系，探索 “5181” 民情处置机制，实行网格化管理，创建 “民情流水线” 工程，实现了政府公共服务、居民自我服务、便民生活服务的统一，做到小事不出社区，大事不出街道。
文化建设上，2006 年成立唐山市首家社区文体协会，组建了书画班、拾秋诗社等 22 支文艺队伍。打造 “文明堂”“书香斋” 等文化阵地，通过开展丰富多彩的文体活动，宣传社会主义核心价值观，弘扬中华优秀传统文化，提升居民文明素养，将社区打造成了精神高档小区。祥富里社区先后获得全国创先争优先进基层党组织、全国文明单位等百余项称号。`,
    images: [
      {
        url: '',
        name: '社区整体面貌照'
      },
      {
        url: '',
        name: '开展丰富多彩的文体活动'
      }
    ]
  }
]

function App() {
  const [currentPage, setCurrentPage] = useState('home');

  // 处理 list，自动填充缺失的图片 URL
  // 遍历 list 中的每个元素，如果 images 中的元素没有 url，则从 imageMap 中根据 name 匹配图片
  const processedList = useMemo(() => {
    return list.map(item => ({
      ...item,
      images: item.images.map(image => {
        // 如果 url 为空，则根据 name 从 imageMap 中查找对应的图片
        if (!image.url && image.name && imageMap[image.name]) {
          return {
            ...image,
            url: imageMap[image.name]
          };
        }
        return image;
      })
    }));
  }, []); // eslint-disable-line react-hooks/exhaustive-deps

  const handleLearnMore = () => {
    setCurrentPage('detail1');
  };

  const handleBackToHome = () => {
    setCurrentPage('home');
  };

  const [selectedItem, setSelectedItem] = useState(null);

  const handleEnterDetail1_2 = (item) => {
    setSelectedItem(item);
    setCurrentPage('detail1_2');
  };

  const handleEnterDetail2 = () => {
    setCurrentPage('detail2');
  };

  const handleEnterDetail2_2 = () => {
    setCurrentPage('detail2_2');
  };

  const handleBackToDetail = () => {
    setCurrentPage('detail1');
  };

  const handleBackToDetail2 = () => {
    setCurrentPage('detail2');
  };
  // 2分钟无交互自动返回Home页
  useEffect(() => {
    let autoReturnTimer = null;

    const resetTimer = () => {
      if (autoReturnTimer) {
        clearTimeout(autoReturnTimer);
      }
      autoReturnTimer = setTimeout(() => {
        setCurrentPage('home');
      }, 300000); // 2分钟 = 300000毫秒
    };

    const handleTouchStart = () => {
      resetTimer();
    };

    // 初始化定时器
    resetTimer();

    // 监听 touchstart 事件
    document.addEventListener('touchstart', handleTouchStart);

    // 清理函数
    return () => {
      if (autoReturnTimer) {
        clearTimeout(autoReturnTimer);
      }
      document.removeEventListener('touchstart', handleTouchStart);
    };
  }, []);


  return (
    <div className="App">
      <div 
        className={`page-container ${currentPage === 'home' ? 'active' : ''}`}
      >
        <Home onLearnMore={handleLearnMore} />
      </div>
      <div 
        className={`page-container ${currentPage === 'detail1' ? 'active' : ''}`}
      >
        <Detail1
          name="新时代基层治理发展（2012年11月-2017年9月）-竖屏1"
          gallery="B馆"
          onBack={handleBackToHome}
          onOpenDetail2={handleEnterDetail2}
          onOpenDetail1_2={handleEnterDetail1_2}
          list={processedList}
          isActive={currentPage === 'detail1'}
        />
      </div>
      <div 
        className={`page-container ${currentPage === 'detail1_2' ? 'active' : ''}`}
      >
        <Detail1Second
          name="新时代基层治理发展（2012年11月-2017年9月）-竖屏2"
          gallery="B馆"
          onBack={handleBackToDetail}
          onOpenDetail2={handleEnterDetail2}
          selectedItem={selectedItem}
          isActive={currentPage === 'detail1_2'}
        />
      </div>
      <div 
        className={`page-container ${currentPage === 'detail2' ? 'active' : ''}`}
      >
        <Detail2
          onBack={handleBackToDetail}
          onOpenDetail2_2={handleEnterDetail2_2}
          isActive={currentPage === 'detail2'}
        />
      </div>
      <div 
        className={`page-container ${currentPage === 'detail2_2' ? 'active' : ''}`}
      >
        <Detail2Second
          onBackToDetail1={handleBackToDetail}
          onOpenDetail2={handleBackToDetail2}
        />
      </div>
    </div>
  );
}

export default App;